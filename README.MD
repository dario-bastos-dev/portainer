# ğŸ³ Portainer + Traefik + Docker Swarm

Uma soluÃ§Ã£o completa para gerenciamento de contÃªineres Docker usando Portainer como interface web, Traefik como proxy reverso e load balancer, tudo rodando em um cluster Docker Swarm.

## ğŸ“‹ O que Ã© esta aplicaÃ§Ã£o?

Esta aplicaÃ§Ã£o fornece uma infraestrutura completa para:

- **Portainer**: Interface web moderna para gerenciar contÃªineres, imagens, volumes, redes e stacks Docker
- **Traefik**: Proxy reverso automÃ¡tico com SSL/TLS (Let's Encrypt) e descoberta de serviÃ§os
- **Docker Swarm**: OrquestraÃ§Ã£o nativa do Docker para alta disponibilidade e escalabilidade

## ğŸš€ CaracterÃ­sticas

### Portainer

- Interface web intuitiva para gerenciar Docker
- Suporte completo ao Docker Swarm
- Gerenciamento de stacks, serviÃ§os e recursos
- Controle de acesso baseado em roles
- Monitoramento em tempo real

### Traefik

- Proxy reverso automÃ¡tico
- Certificados SSL gratuitos via Let's Encrypt
- Descoberta automÃ¡tica de serviÃ§os
- Load balancing inteligente
- Dashboard integrado

### Arquitetura

- **Docker Swarm Mode**: OrquestraÃ§Ã£o nativa
- **Redes Overlay**: ComunicaÃ§Ã£o segura entre serviÃ§os
- **Volumes Persistentes**: Dados seguros e persistentes
- **Alta Disponibilidade**: TolerÃ¢ncia a falhas

## ğŸ“ Estrutura do Projeto

```text
Portainer/
â”œâ”€â”€ portainer-stack.yml     # Stack do Portainer
â”œâ”€â”€ trarfik-stack.yml       # Stack do Traefik
â”œâ”€â”€ README.MD               # Este arquivo
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ install-docker.sh   # InstalaÃ§Ã£o do Docker
â”‚   â””â”€â”€ config-p.sh         # ConfiguraÃ§Ã£o da aplicaÃ§Ã£o
â””â”€â”€ [outros serviÃ§os]/
    â”œâ”€â”€ database/           # PostgreSQL e Redis
    â”œâ”€â”€ n8n/               # AutomaÃ§Ã£o de workflows
    â”œâ”€â”€ chatwoot/          # Atendimento ao cliente
    â”œâ”€â”€ metricas/          # Prometheus e monitoramento
    â””â”€â”€ ...                # Outros microserviÃ§os
```

## ğŸ”§ PrÃ©-requisitos

- **Sistema Operacional**: Ubuntu 20.04+ ou Debian 11+
- **VPS/Servidor**: MÃ­nimo 2GB RAM, 2 vCPUs
- **DomÃ­nio**: Um domÃ­nio prÃ³prio apontando para seu servidor
- **Portas**: 80 (HTTP) e 443 (HTTPS) liberadas no firewall

## ğŸ“– InstalaÃ§Ã£o

### 1. PreparaÃ§Ã£o do Servidor

Execute o script de instalaÃ§Ã£o do Docker:

```bash
chmod +x scripts/install-docker.sh
./scripts/install-docker.sh
```

**âš ï¸ Importante**: Edite o arquivo `install-docker.sh` e substitua `<IP_DA_SUA_VPS>` pelo IP real do seu servidor antes de executar.

### 2. ConfiguraÃ§Ã£o do projeto

Antes de executar a configuraÃ§Ã£o, Ã© necessÃ¡rio configurar alguns campos antes:

- **traefik-stack.yml:** Substitua `<YOUR_EMAIL>` pelo e-mail que deseja utilizar para gerar os certificados SSL.
- **portainer-stack.yml:** Substitua `<YOUR_DOMAIN>` pelo seu domÃ­nio.

### 3. Deploy da AplicaÃ§Ã£o

Execute o script de configuraÃ§Ã£o:

```bash
chmod +x scripts/config-p.sh
./scripts/config-p.sh
```

Este script irÃ¡:

- Criar a rede overlay `traefik-public`
- Fazer deploy do Traefik
- Fazer deploy do Portainer

## ğŸŒ Acesso Ã s AplicaÃ§Ãµes

### Interface do Portainer

- **URL**: `https://portainer.<YOUR_DOMAIN>` (apÃ³s configurar domÃ­nio)
- **Credenciais**: Configure na primeira execuÃ§Ã£o

## ğŸ“Š Monitoramento e Logs

- **Logs em tempo real**: DisponÃ­veis via interface do Portainer
- **MÃ©tricas**: Configure o Prometheus usando os arquivos em `metricas/`
- **Health Checks**: Configurados automaticamente pelo Docker Swarm

## ğŸ›¡ï¸ SeguranÃ§a

### PrÃ¡ticas Implementadas

- **HTTPS ObrigatÃ³rio**: Redirecionamento automÃ¡tico HTTP â†’ HTTPS
- **Certificados SSL**: RenovaÃ§Ã£o automÃ¡tica via Let's Encrypt
- **Isolamento de Rede**: ServiÃ§os em redes overlay dedicadas
- **Acesso Restrito**: Portainer protegido por autenticaÃ§Ã£o

### RecomendaÃ§Ãµes Adicionais

- Configure firewall (UFW) no servidor
- Use senhas fortes no Portainer
- Mantenha as imagens sempre atualizadas
- Configure backups regulares dos volumes

## ğŸ”„ Backup e RestauraÃ§Ã£o

### Backup dos Dados

```bash
# Backup do volume do Portainer
docker run --rm -v portainer_portainer_data:/data -v $(pwd):/backup alpine tar czf /backup/portainer-backup.tar.gz -C /data .

# Backup dos certificados SSL
docker run --rm -v traefik_traefik-ssl-certs:/data -v $(pwd):/backup alpine tar czf /backup/traefik-certs-backup.tar.gz -C /data .
```

### RestauraÃ§Ã£o

```bash
# Restaurar dados do Portainer
docker run --rm -v portainer_portainer_data:/data -v $(pwd):/backup alpine tar xzf /backup/portainer-backup.tar.gz -C /data

# Restaurar certificados SSL
docker run --rm -v traefik_traefik-ssl-certs:/data -v $(pwd):/backup alpine tar xzf /backup/traefik-certs-backup.tar.gz -C /data
```

---

â­ **Dica**: ApÃ³s a instalaÃ§Ã£o, explore os outros serviÃ§os disponÃ­veis na pasta raiz para expandir sua infraestrutura com N8N, Chatwoot, PostgreSQL e outros!
